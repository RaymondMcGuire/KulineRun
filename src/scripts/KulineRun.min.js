var __extends=(this&&this.__extends)||(function(){var a=Object.setPrototypeOf||({__proto__:[]} instanceof Array&&function(e,c){e.__proto__=c})||function(f,c){for(var e in c){if(c.hasOwnProperty(e)){f[e]=c[e]}}};return function(f,c){a(f,c);function e(){this.constructor=f}f.prototype=c===null?Object.create(c):(e.prototype=c.prototype,new e())}})();var Utils;(function(a){var b=(function(){function c(){this.items={}}c.prototype.set=function(d,e){this.items[d]=e};c.prototype["delete"]=function(d){return delete this.items[d]};c.prototype.has=function(d){return d in this.items};c.prototype.get=function(d){return this.items[d]};c.prototype.len=function(){return Object.keys(this.items).length};c.prototype.forEach=function(e){for(var d in this.items){e(d,this.items[d])}};return c}());a.HashSet=b})(Utils||(Utils={}));var ECS;(function(b){var a=(function(){function c(d){this.name=d}return c}());b.Component=a})(ECS||(ECS={}));var Utils;(function(a){var b=(function(){function c(){this.arora=false;this.chrome=false;this.epiphany=false;this.firefox=false;this.mobileSafari=false;this.ie=false;this.ieVersion=0;this.midori=false;this.opera=false;this.safari=false;this.webApp=false;this.cocoonJS=false;this.android=false;this.chromeOS=false;this.iOS=false;this.linux=false;this.macOS=false;this.windows=false;this.desktop=false;this.pixelRatio=0;this.iPhone=false;this.iPhone4=false;this.iPad=false;this.blob=false;this.canvas=false;this.localStorage=false;this.file=false;this.fileSystem=false;this.webGL=false;this.worker=false;this.audioData=false;this.webAudio=false;this.ogg=false;this.opus=false;this.mp3=false;this.wav=false;this.m4a=false;this.webm=false;this.touch=false;var d=navigator.userAgent;this.CheckBrowser(d);this.CheckOS(d);this.CheckDevice();this.CheckAudio();this.CheckFeatures()}c.prototype.CheckBrowser=function(d){if(/Arora/.test(d)){this.arora=true}else{if(/Chrome/.test(d)){this.chrome=true}else{if(/Epiphany/.test(d)){this.epiphany=true}else{if(/Firefox/.test(d)){this.firefox=true}else{if(/Mobile Safari/.test(d)){this.mobileSafari=true}else{if(/MSIE (\d+\.\d+);/.test(d)){this.ie=true;this.ieVersion=parseInt(RegExp.$1,10)}else{if(/Midori/.test(d)){this.midori=true}else{if(/Opera/.test(d)){this.opera=true}else{if(/Safari/.test(d)){this.safari=true}}}}}}}}}if(navigator.standalone){this.webApp=true}if(navigator.isCocoonJS){this.cocoonJS=true}};c.prototype.CheckOS=function(d){if(/Android/.test(d)){this.android=true}else{if(/CrOS/.test(d)){this.chromeOS=true}else{if(/iP[ao]d|iPhone/i.test(d)){this.iOS=true}else{if(/Linux/.test(d)){this.linux=true}else{if(/Mac OS/.test(d)){this.macOS=true}else{if(/Windows/.test(d)){this.windows=true}}}}}}if(this.windows||this.macOS||this.linux){this.desktop=true}};c.prototype.CheckDevice=function(){this.pixelRatio=window.devicePixelRatio||1;this.iPhone=navigator.userAgent.toLowerCase().indexOf("iphone")!==-1;this.iPhone4=(this.pixelRatio===2&&this.iPhone);this.iPad=navigator.userAgent.toLowerCase().indexOf("ipad")!==-1};c.prototype.CheckFeatures=function(){if(typeof window.Blob!=="undefined"){this.blob=true}this.canvas=!!window.CanvasRenderingContext2D;try{this.localStorage=!!localStorage.getItem}catch(d){this.localStorage=false}this.file=!!window.File&&!!window.FileReader&&!!window.FileList&&!!window.Blob;this.fileSystem=!!window.requestFileSystem;this.webGL=!!window.WebGLRenderingContext;this.worker=!!window.Worker;if("ontouchstart" in document.documentElement||window.navigator.msPointerEnabled){this.touch=true}};c.prototype.CheckAudio=function(){this.audioData=!!(window.Audio);this.webAudio=!!(window.webkitAudioContext||window.AudioContext);var g=document.createElement("audio");var d=false;try{if(d=!!g.canPlayType){if(g.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,"")){this.ogg=true}if(g.canPlayType("audio/mpeg;").replace(/^no$/,"")){this.mp3=true}if(g.canPlayType('audio/wav; codecs="1"').replace(/^no$/,"")){this.wav=true}if(g.canPlayType("audio/x-m4a;")||g.canPlayType("audio/aac;").replace(/^no$/,"")){this.m4a=true}}}catch(f){}};c.prototype.PrintInfo=function(){var d="DEVICE OUTPUT\n\n";d+="---\n";d+="Browser Info :: \n";d+="Arora : "+this.arora+"\n";d+="Chrome : "+this.chrome+"\n";d+="Epiphany : "+this.epiphany+"\n";d+="Firefox : "+this.firefox+"\n";d+="Mobile Safari : "+this.mobileSafari+"\n";d+="IE : "+this.ie;if(this.ie){d+=" (Version "+this.ieVersion+")\n"}else{d+="\n"}d+="Midori : "+this.midori+"\n";d+="Opera : "+this.opera+"\n";d+="Safari : "+this.safari+"\n";d+="Web App : "+this.webApp+"\n";d+="CocoonJS : "+this.cocoonJS+"\n";d+="Android : "+this.android+"\n";d+="---\n";d+="Operating System :: \n";d+="Chrome OS : "+this.chromeOS+"\n";d+="iOS : "+this.iOS+"\n";d+="Linux : "+this.linux+"\n";d+="Mac OS : "+this.macOS+"\n";d+="Windows : "+this.windows+"\n";d+="Desktop : "+this.desktop+"\n";d+="---\n";d+="Device Type : \n";d+="Pixel Ratio : "+this.pixelRatio+"\n";d+="iPhone : "+this.iPhone+"\n";d+="iPhone 4 : "+this.iPhone4+"\n";d+="iPad : "+this.iPad+"\n";d+="---\n";d+="Features :: \n";d+="Blob : "+this.blob+"\n";d+="Canvas : "+this.canvas+"\n";d+="LocalStorage : "+this.localStorage+"\n";d+="File : "+this.file+"\n";d+="File System : "+this.fileSystem+"\n";d+="WebGL : "+this.webGL+"\n";d+="Workers : "+this.worker+"\n";d+="---\n";d+="Audio :: \n";d+="AudioData : "+this.audioData+"\n";d+="WebAudio : "+this.webAudio+"\n";d+="Supports .ogg : "+this.ogg+"\n";d+="Supports Opus : "+this.opus+"\n";d+="Supports .mp3 : "+this.mp3+"\n";d+="Supports .wav : "+this.wav+"\n";d+="Supports .m4a : "+this.m4a+"\n";d+="Supports .webm : "+this.webm;return d};return c}());a.DeviceDetect=b})(Utils||(Utils={}));var ECS;(function(a){var b=(function(){function c(d){this.id=d}c.prototype.store=function(d,e){localStorage.setItem(this.id+"."+d,e)};c.prototype.get=function(d){return localStorage.getItem(this.id+"."+d)||0};c.prototype.remove=function(d){localStorage.removeItem(this.id+"."+d)};c.prototype.reset=function(){for(var d in localStorage){if(d.indexOf(this.id+".")!==-1){localStorage.removeItem(d)}}};return c}());a.GameLocalData=b})(ECS||(ECS={}));var ECS;(function(b){var a=(function(){function c(){this.soundPool={};this.device=new Utils.DeviceDetect();this.localData=new b.GameLocalData(b.GameConfig.localID);this.soundList=[{src:"./audio/startScreen",volume:0.6,maxVolume:0.6,loop:true,autoPlay:false,type:"music",name:"StartMusic"},{src:"./audio/gameScreen",volume:0.6,maxVolume:0.6,loop:true,autoPlay:false,type:"music",name:"GameMusic"},{src:"./audio/jump01",volume:0.6,maxVolume:0.6,loop:false,autoPlay:false,type:"music",name:"jump"},{src:"./audio/indoNTiger",volume:0.6,maxVolume:0.6,loop:false,autoPlay:false,type:"music",name:"indoMode"},{src:"./audio/ninjiaStart",volume:0.6,maxVolume:0.6,loop:false,autoPlay:false,type:"music",name:"ninjiaMode"},{src:"./audio/ninjiaAttack",volume:0.6,maxVolume:0.6,loop:false,autoPlay:false,type:"music",name:"ninjiaModeAttack"},{src:"./audio/superMario",volume:0.6,maxVolume:0.6,loop:true,autoPlay:false,type:"music",name:"superMarioMode"},{src:"./audio/catCome",volume:0.6,maxVolume:0.6,loop:false,autoPlay:false,type:"music",name:"catCome"},{src:"./audio/catDead",volume:0.6,maxVolume:0.6,loop:false,autoPlay:false,type:"music",name:"catDead"},{src:"./audio/pickUpFood",volume:0.6,maxVolume:0.6,loop:false,autoPlay:false,type:"music",name:"pickUpFood"},{src:"./audio/playerDead",volume:0.6,maxVolume:0.6,loop:false,autoPlay:false,type:"music",name:"playerDead"}];this.init()}c.prototype.init=function(){for(var d=0;d<this.soundList.length;d++){var e=this.soundList[d];e.audio=new Howl({src:[e.src+".mp3"],html5:true,loop:e.loop,onload:function(){},onloaderror:function(){alert("load sound error!")}});this.soundPool[e.name]=e}};c.prototype.play=function(d){if(this.soundPool.hasOwnProperty(d)){this.soundPool[d].audio.play()}else{console.log("WARNING :: Couldn't find sound '"+d+"'.")}};c.prototype.soundExists=function(d){return this.soundPool.hasOwnProperty(d)};c.prototype.setVolume=function(e,d){if(!this.soundExists(e)){return}Howler.volume(d)};c.prototype.stop=function(d){this.soundPool[d].audio.stop()};return c}());b.GameAudio=a})(ECS||(ECS={}));var ECS;(function(d){var e=(function(){function h(){this.DELTA_TIME=1;this.lastTime=Date.now();this.speed=1}h.prototype.update=function(){var j=Date.now();var i=j;this.currentTime=i;var k=i-this.lastTime;this.DELTA_TIME=((k)*0.06);this.DELTA_TIME*=this.speed;if(this.DELTA_TIME>2.3){this.DELTA_TIME=2.3}this.lastTime=i};return h}());d.GameRunTime=e;var b;(function(h){h[h.JAPAN=0]="JAPAN";h[h.INDON=1]="INDON"})(b=d.FOODMODE||(d.FOODMODE={}));var a;(function(h){h[h.NONE=0]="NONE";h[h.JAPANMODE=1]="JAPANMODE";h[h.INDONMODE=2]="INDONMODE";h[h.NINJAMODE=3]="NINJAMODE"})(a=d.SPECIALMODE||(d.SPECIALMODE={}));var c;(function(h){h[h.TITLE=0]="TITLE";h[h.COUNT_DOWN=1]="COUNT_DOWN";h[h.PLAYING=2]="PLAYING";h[h.GAME_OVER=3]="GAME_OVER";h[h.INTRO=4]="INTRO";h[h.PAUSED=5]="PAUSED"})(c=d.GAMEMODE||(d.GAMEMODE={}));var g;(function(h){h[h.RUNNING=0]="RUNNING";h[h.JUMPING1=1]="JUMPING1";h[h.JUMPING2=2]="JUMPING2";h[h.FALL=3]="FALL";h[h.SLIDE=4]="SLIDE"})(g=d.PLAYMODE||(d.PLAYMODE={}));var f=(function(){function h(){}h.timeClock=function(){return this.tmpTimeClockEnd-this.tmpTimeClockStart};h.timeClock1=function(){return this.tmpTimeClockEnd1-this.tmpTimeClockStart1};h.width=800;h.height=600;h.fixedHeight=600;h.xOffset=0;h.high_mode=true;h.camera=new PIXI.Point();h.localID="rw.raymond.wang";h.newHighScore=false;h.time=new e();h.interactive=true;h.specialMode=a.NONE;h.isOnPlat=false;return h}());d.GameConfig=f})(ECS||(ECS={}));var ECS;(function(b){var a=(function(){function c(d){this.name=d}c.prototype.Init=function(){console.log("["+this.name+"]System initialization!")};c.prototype.Execute=function(){console.log("["+this.name+"]System Execute!")};return c}());b.System=a})(ECS||(ECS={}));var ECS;(function(a){var b=(function(){function c(d){this.name=d;this.id=(+new Date()).toString(16)+(Math.random()*100000000|0).toString(16)+this.count;this.count++;this.components=new Utils.HashSet()}c.prototype.addComponent=function(d){this.components.set(d.name,d)};c.prototype.removeComponent=function(f){var e=f.name;var d=this.components["delete"](e);if(d){console.log("delete ["+e+"] success!")}else{console.log("delete ["+e+"] fail! not exist!")}};return c}());a.Entity=b})(ECS||(ECS={}));var ECS;(function(b){var c=(function(){function d(h){this.sprites=[];this.spriteWidth=h.width-5;this.spriteHeight=b.GameConfig.height*4/5;var g=3;for(var f=0;f<g;f++){var e=new PIXI.Sprite(h);e.height=b.GameConfig.height*4/5;e.position.y=0;this.sprites.push(e)}this.speed=1}d.prototype.setPosition=function(e){var g=this.spriteWidth;for(var f=0;f<this.sprites.length;f++){var j=-e*this.speed;j+=f*g;j%=g*this.sprites.length;j+=g/2;if(!b.GameConfig.device.desktop){j+=g/2}this.sprites[f].position.x=j}};return d}());b.BackGroundElement=c;var a=(function(e){__extends(d,e);function d(){var j=e.call(this,"view-background")||this;j.BackGroundContainer=new PIXI.Container();j.width=b.GameConfig.width;j.scrollPosition=b.GameConfig.camera.x;var f=PIXI.loader.resources["img/bg_up.png"].texture;if(!b.GameConfig.device.desktop){f=PIXI.loader.resources["img/bg_up_ios.png"].texture}j.bgTex=new c(f);for(var g=0;g<j.bgTex.sprites.length;g++){j.BackGroundContainer.addChild(j.bgTex.sprites[g])}j.groundAssetList=["obstacle-11.png","tree1.png","obstacle-13.png","tree2.png"];j.groundSpriteList=[];for(var g=0;g<j.groundAssetList.length;g++){var h=PIXI.Sprite.fromFrame(j.groundAssetList[g]);h.anchor.x=0.5;h.anchor.y=0.5;h.width=140*b.GameConfig.height/b.GameConfig.fixedHeight;h.height=240*b.GameConfig.height/b.GameConfig.fixedHeight;h.position.y=j.bgTex.spriteHeight-h.height/2;j.BackGroundContainer.addChild(h);j.groundSpriteList.push(h)}j.cloud1=PIXI.Sprite.fromFrame("cloud1.png");j.cloud1.position.y=b.GameConfig.height/5;j.BackGroundContainer.addChild(j.cloud1);j.cloud2=PIXI.Sprite.fromFrame("cloud2.png");j.cloud2.position.y=b.GameConfig.height/8;j.BackGroundContainer.addChild(j.cloud2);j.bgTex.speed=1/2;b.GameConfig.app.ticker.add(function(p){j.scrollPosition=b.GameConfig.camera.x;var l=j.bgTex.sprites[0].width/4;var o=-j.scrollPosition*1.5/2;o%=j.width+l;o+=j.width+l;o-=j.cloud1.width/2;j.cloud1.position.x=o-b.GameConfig.xOffset;var m=-(j.scrollPosition+j.width/2)*1.5/2;m%=j.width+l;m+=j.width+l;m-=j.cloud2.width/2;j.cloud2.position.x=m-b.GameConfig.xOffset;for(var k=0;k<j.groundAssetList.length;k++){var n=-(j.scrollPosition+j.width*(k+1))*3/4;n%=j.width+l;n+=j.width+l;n-=j.groundSpriteList[k].width/2;j.groundSpriteList[k].position.x=n-b.GameConfig.xOffset}j.bgTex.setPosition(j.scrollPosition)});return j}return d}(b.System));b.GameBackGroundSystem=a})(ECS||(ECS={}));var ECS;(function(b){function h(p){var l=p.toString().split("");var o="";var k=l.length;var m=(k%3)-1;for(var j=0;j<k;j++){o+=l[j]}return o}var i=(function(){function j(){this.uiContainer=new PIXI.Container();this.uiBtnAtk=new PIXI.Sprite(PIXI.loader.resources["img/PlayPanel/btn_atk.png"].texture);this.uiBtnJump=new PIXI.Sprite(PIXI.loader.resources["img/PlayPanel/btn_jump.png"].texture);this.uiBtnSlide=new PIXI.Sprite(PIXI.loader.resources["img/PlayPanel/btn_slide.png"].texture);this.uiBtnAtk.anchor.set(0.5);this.uiBtnJump.anchor.set(0.5);this.uiBtnSlide.anchor.set(0.5);this.uiBtnAtk.scale.set(0.4);this.uiBtnJump.scale.set(0.5);this.uiBtnSlide.scale.set(0.5);this.uiBtnSlide.position.y=b.GameConfig.height*4/5-this.uiBtnSlide.height/2;this.uiBtnSlide.position.x=10+this.uiBtnSlide.width/2;this.uiBtnJump.position.y=b.GameConfig.height*4/5-this.uiBtnSlide.height/2-this.uiBtnJump.height/2-40;this.uiBtnJump.position.x=10+this.uiBtnJump.width/2;this.uiBtnAtk.position.y=b.GameConfig.height*4/5-this.uiBtnAtk.height/2-10;this.uiBtnAtk.position.x=b.GameConfig.width-this.uiBtnAtk.width/2-10;this.uiBtnAtk.interactive=true;this.uiBtnJump.interactive=true;this.uiBtnSlide.interactive=true;this.uiBtnAtk.on("touchstart",function(){if(b.GameConfig.game.isPlaying&&b.GameConfig.specialMode==b.SPECIALMODE.JAPANMODE){b.GameConfig.audio.play("ninjiaModeAttack");b.GameConfig.game.player.view.textures=b.GameConfig.game.player.dashFrames;b.GameConfig.game.player.view.play();b.GameConfig.game.player.ninjiaOperate()}else{if(b.GameConfig.game.isPlaying&&b.GameConfig.specialMode==b.SPECIALMODE.INDONMODE){b.GameConfig.audio.play("indoMode");b.GameConfig.game.player.view.textures=b.GameConfig.game.player.runningFrames;b.GameConfig.game.player.view.play();b.GameConfig.game.player.indoOperate()}}});this.uiBtnJump.on("touchstart",function(){if(b.GameConfig.game.isPlaying&&b.GameConfig.playerMode==b.PLAYMODE.RUNNING&&!b.GameConfig.game.player.isPlayingNinjiaEffect){b.GameConfig.game.player.jump();b.GameConfig.audio.play("jump")}else{if(b.GameConfig.game.isPlaying&&b.GameConfig.playerMode==b.PLAYMODE.FALL&&b.GameConfig.game.player.startJump==true&&!b.GameConfig.game.player.isPlayingNinjiaEffect){b.GameConfig.game.player.jumpTwo();b.GameConfig.audio.play("jump")}}});this.uiBtnSlide.on("touchstart",function(){if(b.GameConfig.game.isPlaying&&b.GameConfig.playerMode==b.PLAYMODE.RUNNING&&b.GameConfig.game.player.onGround){b.GameConfig.game.player.slide(true)}});this.uiBtnSlide.on("touchend",function(){if(b.GameConfig.game.isPlaying&&b.GameConfig.game.player.isSlide){b.GameConfig.game.player.slide(false)}});this.uiContainer.addChild(this.uiBtnJump);this.uiContainer.addChild(this.uiBtnSlide);this.uiContainer.addChild(this.uiBtnAtk)}return j}());b.GameUIPanelControl=i;var d=(function(){function j(){this.ratio=0.6;this.uiContainer=new PIXI.Container();this.uiList=["Score.png","Best Score.png","Distance.png","Pause.png"];this.startXList=new Array();this.startYList=new Array();var k=0;this.uiSprites=[];for(var l=0;l<this.uiList.length;l++){this.uiList[l]=PIXI.Texture.fromFrame(this.uiList[l]);this.uiSprites[l]=new PIXI.Sprite(this.uiList[l]);this.uiSprites[l].scale.x=this.ratio;this.uiSprites[l].scale.y=this.ratio;k+=this.uiSprites[l].width}this.startX=b.GameConfig.width-k;for(var l=0;l<this.uiList.length;l++){this.startXList.push(this.startX);this.startYList.push(this.uiSprites[l].height);this.uiContainer.addChild(this.uiSprites[l]);this.uiSprites[l].position.x=this.startX;this.startX+=this.uiSprites[l].width}}return j}());b.GameUIPanelUpRight=d;var c=(function(){function j(l,n){this.currentScore=0;this.ratio=1;this.xOffset=15;this.yOffset=15;this.ratio=0.3;this.startX=l[1];this.startY=n[0];this.container=new PIXI.Container();this.tmpList=[];this.numberList={0:"Number-0.png",1:"Number-1.png",2:"Number-2.png",3:"Number-3.png",4:"Number-4.png",5:"Number-5.png",6:"Number-6.png",7:"Number-7.png",8:"Number-8.png",9:"Number-9.png"};for(var m in this.numberList){this.numberList[m]=PIXI.Texture.fromFrame(this.numberList[m])}this.numberSprite=[];for(var k=0;k<10;k++){this.numberSprite[k]=new PIXI.Sprite(this.numberList[k]);this.numberSprite[k].scale.x=this.ratio;this.numberSprite[k].scale.y=this.ratio}this.setScore(0)}j.prototype.resetScore=function(){for(var k=0;k<this.tmpList.length;k++){this.container.removeChild(this.tmpList[k])}};j.prototype.setScore=function(r){this.currentScore=r;this.resetScore();var p=h(r).split("");var k=this.startX-this.xOffset;var o=0;for(var n=0;n<p.length;n++){var m=this.numberList[p[n]].width*this.ratio;o+=m}k-=o;for(var n=0;n<p.length;n++){var q=this.numberSprite[n];q.visible=true;q.setTexture(this.numberList[p[n]]);q.position.x=k;q.position.y=this.startY/2-this.yOffset;k+=q.width;this.tmpList.push(q);this.container.addChild(q)}};return j}());b.NumberUI=c;var a=(function(k){__extends(j,k);function j(l,m){return k.call(this,l,m)||this}return j}(c));b.Score=a;var e=(function(k){__extends(j,k);function j(l,n){var m=k.call(this,l,n)||this;m.startX=l[2];m.LocalData=new b.GameLocalData(b.GameConfig.localID);m.hightScore=m.LocalData.get("highscore")||0;m.update();return m}j.prototype.update=function(){this.setScore(this.LocalData.get("highscore")||0)};return j}(c));b.BestScore=e;var g=(function(k){__extends(j,k);function j(l,n){var m=k.call(this,l,n)||this;m.startX=l[3];m.setScore(0);return m}return j}(c));b.DistanceScore=g;var f=(function(){function j(){this.uiContainer=new PIXI.Container();this.foods=["Food Grey.png","Food Grey.png","Food Grey.png","Food Grey.png"];this.activeFoods=["Food.png","Food.png","Food.png","Food.png"];for(var k=0;k<4;k++){this.foods[k]=PIXI.Texture.fromFrame(this.foods[k]);this.activeFoods[k]=PIXI.Texture.fromFrame(this.activeFoods[k])}this.startX=10;this.digits=[];for(var k=0;k<4;k++){this.digits[k]=new PIXI.Sprite(this.foods[k]);this.digits[k].scale.x=0.6;this.digits[k].scale.y=0.6;this.uiContainer.addChild(this.digits[k]);this.setFoodPic(this.digits[k],k*this.digits[k].width)}}j.prototype.setFoodPic=function(l,k){l.position.x=this.startX+k};return j}());b.SpecialfoodUI=f})(ECS||(ECS={}));var ECS;(function(b){var a=(function(){function c(){this.japanFoodTextures=["RAMEN.png","OKONOMIYAKI.png","DANGO.png","TEPURA.png"];this.indoFoodTextures=["BATAGOR.png","CIRENG.png","SEBLAK.png","HAMBURG.png"];this.position=new PIXI.Point();var d=Math.random()*10;if(d>5){this.clip=new PIXI.Sprite(PIXI.Texture.fromFrame(this.japanFoodTextures[Math.floor(Math.random()*this.japanFoodTextures.length)]));this.shine=new PIXI.Sprite(PIXI.Texture.fromImage("img/light2.png"));this.foodType=b.FOODMODE.JAPAN;this.shine.scale.y*=0.5}else{this.clip=new PIXI.Sprite(PIXI.Texture.fromFrame(this.indoFoodTextures[Math.floor(Math.random()*this.indoFoodTextures.length)]));this.shine=PIXI.Sprite.fromFrame("pickupShine.png");this.foodType=b.FOODMODE.INDON}this.view=new PIXI.Container();this.clip.anchor.x=0.5;this.clip.anchor.y=0.5;this.shine.anchor.x=this.shine.anchor.y=0.5;this.shine.scale.x=this.shine.scale.y*b.GameConfig.height/b.GameConfig.fixedHeight;this.shine.alpha=0.8;this.view.addChild(this.shine);this.view.addChild(this.clip);this.width=b.GameConfig.height*100/b.GameConfig.fixedHeight;this.height=b.GameConfig.height*100/b.GameConfig.fixedHeight;this.count=Math.random()*300}c.prototype.update=function(){if(!this.isPickedUp){this.count+=0.1*b.GameConfig.time.DELTA_TIME;this.clip.scale.x=b.GameConfig.height*0.4/b.GameConfig.fixedHeight+Math.sin(this.count)*0.1;this.clip.scale.y=b.GameConfig.height*0.4/b.GameConfig.fixedHeight-Math.cos(this.count)*0.1;this.clip.rotation=Math.sin(this.count*1.5)*0.2;this.shine.rotation=this.count*0.2}else{this.view.scale.x=1-this.ratio;this.view.scale.y=1-this.ratio;this.position.x=this.pickupPosition.x+(this.player.position.x-this.pickupPosition.x)*this.ratio;this.position.y=this.pickupPosition.y+(this.player.position.y-this.pickupPosition.y)*this.ratio}this.view.position.x=this.position.x-b.GameConfig.camera.x;this.view.position.y=this.position.y};return c}());b.PickUp=a})(ECS||(ECS={}));var ECS;(function(b){var a=(function(d){__extends(c,d);function c(){var e=d.call(this,"game view")||this;e.renderer=b.GameConfig.app.renderer;e.GameStage=new PIXI.Container();e.GameContainer=new PIXI.Container();e.hudContainer=new PIXI.Container();e.game=new PIXI.Container();e.gameFront=new PIXI.Container();e.GameContainer.addChild(e.game);e.GameContainer.addChild(e.gameFront);e.GameStage.addChild(e.GameContainer);e.GameStage.addChild(e.hudContainer);e.background=(b.GameConfig.allSystem.get("background")).BackGroundContainer;e.game.addChild(e.background);e.count=0;e.zoom=1;b.GameConfig.xOffset=e.GameContainer.position.x;b.GameConfig.app.stage.addChild(e.GameStage);return e}c.prototype.showHud=function(){this.specialFood=new b.SpecialfoodUI();this.UIPanelUpRight=new b.GameUIPanelUpRight();this.scoreUI=new b.Score(this.UIPanelUpRight.startXList,this.UIPanelUpRight.startYList);this.bestScoreUI=new b.BestScore(this.UIPanelUpRight.startXList,this.UIPanelUpRight.startYList);this.distanceScoreUI=new b.DistanceScore(this.UIPanelUpRight.startXList,this.UIPanelUpRight.startYList);if(!b.GameConfig.device.desktop){this.userControlUI=new b.GameUIPanelControl();this.hudContainer.addChild(this.userControlUI.uiContainer)}this.hudContainer.addChild(this.UIPanelUpRight.uiContainer);this.hudContainer.addChild(this.scoreUI.container);this.hudContainer.addChild(this.bestScoreUI.container);this.hudContainer.addChild(this.distanceScoreUI.container);this.hudContainer.addChild(this.specialFood.uiContainer)};c.prototype.update=function(){var k=b.GameConfig.game;this.count+=0.01;var i=(this.zoom-1);var g=-b.GameConfig.width/2;var f=-k.player.view.position.x;var e=g+(f-g)*i;this.GameContainer.position.x=e*this.zoom;this.GameContainer.position.y=-k.player.view.position.y*this.zoom;this.GameContainer.position.x+=b.GameConfig.width/2;this.GameContainer.position.y+=b.GameConfig.height/2;b.GameConfig.xOffset=this.GameContainer.position.x;if(this.GameContainer.position.y>0){this.GameContainer.position.y=0}var j=-b.GameConfig.height*this.zoom;j+=b.GameConfig.height;if(this.GameContainer.position.y<j){this.GameContainer.position.y=j}this.GameContainer.scale.x=this.zoom;this.GameContainer.scale.y=this.zoom;if(this.scoreUI.currentScore!=k.score){this.scoreUI.setScore(k.score)}if(this.distanceScoreUI.currentScore!=k.distanceScore){this.distanceScoreUI.setScore(k.distanceScore)}var h=this.bestScoreUI.LocalData.get("highscore")||0;if(this.bestScoreUI.highScore!=h){this.bestScoreUI.update()}this.renderer.render(b.GameConfig.app.stage)};c.prototype.normalMode=function(){this.game.removeChild(this.background);this.game.addChildAt(this.background,0);this.white.alpha=1;TweenLite.to(this.white,0.5,{alpha:0,ease:Sine.easeOut})};return c}(b.System));b.GameViewSystem=a})(ECS||(ECS={}));var ECS;(function(a){var c=(function(){function d(){this.isSlide=false;this.ninjiaEffectNumber=0;this.isPlayingNinjiaEffect=false;this.isPlayingInoEffect=false;this.position=new PIXI.Point();this.speedUpList=[];this.runningFrames=[PIXI.Texture.fromFrame("CHARACTER/RUN/Character-01.png"),PIXI.Texture.fromFrame("CHARACTER/RUN/Character-02.png"),PIXI.Texture.fromFrame("CHARACTER/RUN/Character-03.png"),PIXI.Texture.fromFrame("CHARACTER/RUN/Character-04.png"),PIXI.Texture.fromFrame("CHARACTER/RUN/Character-05.png"),PIXI.Texture.fromFrame("CHARACTER/RUN/Character-06.png")];this.indoTightFrame=[PIXI.Texture.fromFrame("CHARACTER/POWER EFFECTS/INDONTIGHT/boom0001.png"),PIXI.Texture.fromFrame("CHARACTER/POWER EFFECTS/INDONTIGHT/boom0002.png"),PIXI.Texture.fromFrame("CHARACTER/POWER EFFECTS/INDONTIGHT/boom0003.png"),PIXI.Texture.fromFrame("CHARACTER/POWER EFFECTS/INDONTIGHT/boom0004.png")];this.jumpFrames=[PIXI.Texture.fromFrame("CHARACTER/JUMP/Jump.png")];this.slideFrame=[PIXI.Texture.fromFrame("CHARACTER/SLIDE/Slide.png")];this.dashFrames=[PIXI.Texture.fromFrame("CHARACTER/POWER/DASH/dash0002.png")];this.shootFrame=[PIXI.Texture.fromFrame("CHARACTER/POWER/SHOOT/shoot0001.png"),PIXI.Texture.fromFrame("CHARACTER/POWER/SHOOT/shoot0002.png")];this.view=new PIXI.extras.AnimatedSprite(this.runningFrames);this.view.animationSpeed=0.23;this.view.anchor.x=0.5;this.view.anchor.y=0.5;this.view.height=115*a.GameConfig.height/a.GameConfig.fixedHeight;this.view.width=65*a.GameConfig.height/a.GameConfig.fixedHeight;this.position.x=(a.GameConfig.allSystem.get("background")).bgTex.spriteWidth+100;if(!a.GameConfig.device.desktop){this.position.x=2*(a.GameConfig.allSystem.get("background")).bgTex.spriteWidth+100}this.floorSpriteHeight=(a.GameConfig.allSystem.get("background")).bgTex.spriteHeight;this.refreshFloorHeight();this.gravity=9.8;this.baseSpeed=12;this.speed=new PIXI.Point(this.baseSpeed,0);this.activeCount=0;this.isJumped=false;this.accel=0;this.width=26;this.height=37;this.onGround=true;this.rotationSpeed=0;this.joyRiding=false;this.level=1;this.realAnimationSpeed=0.23;this.volume=0.3;this.vStart=35;this.mass=65;this.angle=Math.PI*45/360;this.startJump=false;this.b_jumpTwo=false;this.smooth=0.05;this.cnt=0;this.shinobiEffect1=new PIXI.Sprite(PIXI.Texture.fromImage("img/dash_stock.png"));this.shinobiEffect1.anchor.x=-1.5;this.shinobiEffect1.anchor.y=5.5;this.shinobiEffect1.scale.x=0.2;this.shinobiEffect1.scale.y=0.2;this.shinobiEffect2=new PIXI.Sprite(PIXI.Texture.fromImage("img/dash_stock.png"));this.shinobiEffect2.anchor.x=0;this.shinobiEffect2.anchor.y=5.5;this.shinobiEffect2.scale.x=0.2;this.shinobiEffect2.scale.y=0.2;this.shinobiEffect3=new PIXI.Sprite(PIXI.Texture.fromImage("img/dash_stock.png"));this.shinobiEffect3.anchor.x=1.5;this.shinobiEffect3.anchor.y=5.5;this.shinobiEffect3.scale.x=0.2;this.shinobiEffect3.scale.y=0.2;this.backEffect=new PIXI.Sprite(PIXI.Texture.fromImage("img/blade.png"));this.backEffect.anchor.x=0.8;this.backEffect.anchor.y=0.5;this.backEffect.scale.x=1;this.backEffect.scale.y=1;this.specialEffectView=new PIXI.Sprite(PIXI.Texture.fromFrame("CHARACTER/POWER EFFECTS/DASH/dash-shinobi-new.png"));this.specialEffectView.anchor.x=0.2;this.specialEffectView.anchor.y=0.5;this.specialEffectView.scale.x=2;this.specialEffectView.scale.y=2;this.indoEffect=new PIXI.Sprite(PIXI.Texture.fromFrame("CHARACTER/POWER EFFECTS/SHOOT/maung shoot-new.png"));this.indoEffect.anchor.x=0.2;this.indoEffect.anchor.y=0.6;this.indoEffect.scale.x=2;this.indoEffect.scale.y=2;this.marioEffect=new PIXI.Sprite(PIXI.Texture.fromFrame("CHARACTER/POWER EFFECTS/MARIO/maung ninja.png"));this.marioEffect.anchor.x=0.1;this.marioEffect.anchor.y=0.52;this.marioEffect.scale.x=2;this.marioEffect.scale.y=2;this.indonTight=new PIXI.extras.AnimatedSprite(this.indoTightFrame);this.indonTight.animationSpeed=0.1;this.indonTight.anchor.x=0.5;this.indonTight.anchor.y=0.5;this.indonTight.height=a.GameConfig.height/2;this.indonTight.width=a.GameConfig.width/2;this.view.play()}d.prototype.update=function(){if(this.isDead){this.updateDieing()}else{this.updateRunning()}};d.prototype.normalMode=function(){this.joyRiding=false;TweenLite.to(this.speed,0.6,{x:this.baseSpeed,ease:Cubic.easeOut});this.realAnimationSpeed=0.23};d.prototype.chkOnGround=function(){if(this.onGround){return true}return false};d.prototype.resetSpecialFoods=function(){for(var e=0;e<4;e++){a.GameConfig.game.view.specialFood.digits[e].texture=a.GameConfig.game.view.specialFood.foods[e]}};d.prototype.ninjiaOperate=function(){if(this.ninjiaEffectNumber<3&&!this.isPlayingNinjiaEffect){this.isPlayingNinjiaEffect=true;a.GameConfig.tmpTimeClockStart=a.GameConfig.time.currentTime;this.view.addChild(this.specialEffectView);switch(this.ninjiaEffectNumber){case 0:this.view.removeChild(this.shinobiEffect1);break;case 1:this.view.removeChild(this.shinobiEffect2);break;case 2:this.view.removeChild(this.shinobiEffect3);break}this.speed.x*=10;this.ninjiaEffectNumber++}};d.prototype.indoOperate=function(){if(!this.isPlayingInoEffect){this.view.textures=this.shootFrame;this.view.play();a.GameConfig.tmpTimeClockStart=a.GameConfig.time.currentTime;this.view.addChild(this.indoEffect);(a.GameConfig.allSystem.get("view")).game.addChild(this.indonTight);this.indonTight.textures=this.indoTightFrame;this.indonTight.play();this.isPlayingInoEffect=true}};d.prototype.ninjaMode=function(){if(this.isPlayingNinjiaEffect){a.GameConfig.tmpTimeClockEnd=a.GameConfig.time.currentTime;var e=a.GameConfig.timeClock();if(e>200){this.view.textures=this.runningFrames;this.view.play();this.speed.x/=10;this.view.removeChild(this.specialEffectView);this.isPlayingNinjiaEffect=false;if(this.ninjiaEffectNumber==3){this.ninjiaEffectNumber=0;a.GameConfig.specialMode=a.SPECIALMODE.NONE;a.GameConfig.game.pickupManager.pickedUpPool=[];a.GameConfig.game.pickupManager.canPickOrNot=true;this.resetSpecialFoods();this.view.removeChild(this.backEffect)}}}};d.prototype.marioMode=function(){a.GameConfig.tmpTimeClockEnd=a.GameConfig.time.currentTime;var e=a.GameConfig.timeClock();if(e>10000){a.GameConfig.specialMode=a.SPECIALMODE.NONE;a.GameConfig.game.pickupManager.pickedUpPool=[];a.GameConfig.game.pickupManager.canPickOrNot=true;this.speed.x/=2;this.view.removeChild(this.marioEffect);this.resetSpecialFoods();a.GameConfig.audio.stop("superMarioMode");a.GameConfig.audio.play("GameMusic")}};d.prototype.indoMode=function(){if(this.isPlayingInoEffect){this.indonTight.position.x=this.position.x-a.GameConfig.camera.x;this.indonTight.position.y=this.position.y-a.GameConfig.camera.y;a.GameConfig.tmpTimeClockEnd=a.GameConfig.time.currentTime;var e=a.GameConfig.timeClock();if(e>1000){this.isPlayingInoEffect=false;a.GameConfig.specialMode=a.SPECIALMODE.NONE;a.GameConfig.game.pickupManager.pickedUpPool=[];a.GameConfig.game.pickupManager.canPickOrNot=true;(a.GameConfig.allSystem.get("view")).game.removeChild(this.indonTight);this.view.removeChild(this.indoEffect);this.resetSpecialFoods()}}};d.prototype.refreshFloorHeight=function(){this.floorHeight=this.floorSpriteHeight-this.view.height*0.5;this.view.position.y=this.floorHeight;this.position.y=this.floorHeight;this.ground=this.floorHeight};d.prototype.updateRunning=function(){this.view.animationSpeed=this.realAnimationSpeed*a.GameConfig.time.DELTA_TIME*this.level;this.indonTight.animationSpeed=this.realAnimationSpeed*a.GameConfig.time.DELTA_TIME*this.level;var e=Math.floor(a.GameConfig.game.distanceScore/2);if(e!=0&&!this.speedUpList.includes(e)&&a.GameConfig.game.distanceScore<20){this.speedUpList.push(e);this.speed.x*=1.1}switch(a.GameConfig.playerMode){case a.PLAYMODE.JUMPING1:this.speed.y=-this.vStart*Math.sin(this.angle);break;case a.PLAYMODE.JUMPING2:this.speed.y=-this.vStart*Math.sin(this.angle);break;case a.PLAYMODE.FALL:this.speed.y+=this.gravity*a.GameConfig.time.DELTA_TIME*this.smooth;break;case a.PLAYMODE.RUNNING:this.speed.y=0;break;case a.PLAYMODE.SLIDE:this.speed.y=0;break}if(!this.chkOnGround()&&(a.GameConfig.playerMode==a.PLAYMODE.JUMPING1||a.GameConfig.playerMode==a.PLAYMODE.JUMPING2)){a.GameConfig.playerMode=a.PLAYMODE.FALL}else{if(a.GameConfig.playerMode==a.PLAYMODE.FALL&&this.chkOnGround()){a.GameConfig.playerMode=a.PLAYMODE.RUNNING}}this.position.x+=this.speed.x*a.GameConfig.time.DELTA_TIME*this.level;this.position.y+=this.speed.y*a.GameConfig.time.DELTA_TIME;if(this.onGround&&a.GameConfig.playerMode==a.PLAYMODE.RUNNING&&this.view.textures!=this.runningFrames&&!this.isPlayingInoEffect){this.view.anchor.y=0.5;this.view.textures=this.runningFrames;this.view.play()}else{if(a.GameConfig.playerMode==a.PLAYMODE.SLIDE&&this.view.textures!=this.slideFrame){this.view.anchor.y=0.1;this.view.textures=this.slideFrame;this.view.play()}else{if((a.GameConfig.playerMode==a.PLAYMODE.JUMPING1||a.GameConfig.playerMode==a.PLAYMODE.JUMPING2)&&this.view.textures!=this.jumpFrames){this.view.textures=this.jumpFrames;this.view.play()}}}switch(a.GameConfig.specialMode){case a.SPECIALMODE.NONE:break;case a.SPECIALMODE.NINJAMODE:this.marioMode();break;case a.SPECIALMODE.JAPANMODE:if(this.ninjiaEffectNumber<=3){this.ninjaMode()}break;case a.SPECIALMODE.INDONMODE:this.indoMode();break}a.GameConfig.camera.x=this.position.x-100;a.GameConfig.game.distanceScore=Math.floor(this.position.x/10000);this.view.position.x=this.position.x-a.GameConfig.camera.x;this.view.position.y=this.position.y-a.GameConfig.camera.y;this.view.rotation+=(this.speed.y*0.05-this.view.rotation)*0.1};d.prototype.updateDieing=function(){this.speed.x*=0.999;if(this.onGround){this.speed.y*=0.99}this.speed.y+=0.1;this.accel+=(0-this.accel)*0.1*a.GameConfig.time.DELTA_TIME;this.speed.y+=this.gravity*a.GameConfig.time.DELTA_TIME;this.position.x+=this.speed.x*a.GameConfig.time.DELTA_TIME;this.position.y+=this.speed.y*a.GameConfig.time.DELTA_TIME;a.GameConfig.camera.x=this.position.x-100;this.view.position.x=this.position.x-a.GameConfig.camera.x;this.view.position.y=this.position.y-a.GameConfig.camera.y;if(this.speed.x<5){this.view.rotation+=this.rotationSpeed*(this.speed.x/5)*a.GameConfig.time.DELTA_TIME}else{this.view.rotation+=this.rotationSpeed*a.GameConfig.time.DELTA_TIME}};d.prototype.jump=function(){if(this.isDead){if(this.speed.x<5){this.isDead=false;this.speed.x=10}}this.startJump=true;a.GameConfig.playerMode=a.PLAYMODE.JUMPING1};d.prototype.jumpTwo=function(){if(this.isDead){if(this.speed.x<5){this.isDead=false;this.speed.x=10}}this.startJump=false;a.GameConfig.playerMode=a.PLAYMODE.JUMPING2};d.prototype.slide=function(e){if(this.isDead){if(this.speed.x<5){this.isDead=false;this.speed.x=10}}if(a.GameConfig.playerMode!=a.PLAYMODE.SLIDE&&this.position.y==this.ground){this.isSlide=e;if(e){a.GameConfig.playerMode=a.PLAYMODE.SLIDE}}else{if(!e){this.onGround=true;this.position.y=this.ground;this.isSlide=e;a.GameConfig.playerMode=a.PLAYMODE.RUNNING}}};d.prototype.die=function(){if(this.isDead){return}a.GameConfig.audio.play("playerDead");TweenLite.to(a.GameConfig.time,0.5,{speed:0.1,ease:Cubic.easeOut,onComplete:function(){TweenLite.to(a.GameConfig.time,2,{speed:1,delay:1})}});this.isDead=true;this.bounce=0;this.speed.x=15;this.speed.y=-15;this.rotationSpeed=0.3;this.view.stop()};d.prototype.boil=function(){if(this.isDead){return}this.isDead=true};d.prototype.fall=function(){this.startJump=false;this.isJumped=true};d.prototype.isAirbourne=function(){};d.prototype.stop=function(){this.view.stop()};d.prototype.resume=function(){this.view.play()};return d}());a.GameCharacter=c;var b=(function(){function d(){this.isEatNow=false;this.isExploded=false;this.position=new PIXI.Point();this.isHit=false;this.width=150;this.height=150;this.speed=-10+Math.random()*20;this.moveingFrames=[PIXI.Texture.fromFrame("CHARACTER/NEKO/WALK/neko0001.png"),PIXI.Texture.fromFrame("CHARACTER/NEKO/WALK/neko0002.png"),PIXI.Texture.fromFrame("CHARACTER/NEKO/WALK/neko0003.png"),PIXI.Texture.fromFrame("CHARACTER/NEKO/WALK/neko0004.png")];this.stealFrames=[PIXI.Texture.fromFrame("CHARACTER/NEKO/STEAL/steal0001.png"),PIXI.Texture.fromFrame("CHARACTER/NEKO/STEAL/steal0002.png"),PIXI.Texture.fromFrame("CHARACTER/NEKO/STEAL/steal0003.png"),PIXI.Texture.fromFrame("CHARACTER/NEKO/STEAL/steal0004.png")];this.view=new PIXI.extras.AnimatedSprite(this.moveingFrames);this.view.animationSpeed=0.23;this.view.anchor.x=0.5;this.view.anchor.y=0.5;this.view.height=a.GameConfig.height*130/a.GameConfig.fixedHeight;this.view.width=a.GameConfig.height*130/a.GameConfig.fixedHeight;this.view.play()}d.prototype.reset=function(){this.isHit=false};d.prototype.hit=function(){if(this.isHit){return}this.isHit=true;a.GameConfig.audio.play("catDead");this.view.setTexture(PIXI.Texture.fromImage("img/empty.png"))};d.prototype.update=function(){this.view.animationSpeed=0.23*a.GameConfig.time.DELTA_TIME;this.view.position.x=this.position.x-a.GameConfig.camera.x;if(!this.isEatNow){this.position.x+=this.speed*Math.sin(a.GameConfig.time.DELTA_TIME);a.GameConfig.tmpTimeClockStart1=a.GameConfig.time.currentTime}else{a.GameConfig.tmpTimeClockEnd1=a.GameConfig.time.currentTime;if(a.GameConfig.timeClock1()>2000){this.isEatNow=false;this.view.textures=this.moveingFrames;this.view.play();a.GameConfig.audio.play("catCome")}}this.view.position.y=this.position.y};return d}());a.GameEnemy=b})(ECS||(ECS={}));var ECS;(function(b){var a=(function(){function k(l){this.classType=l;this.pool=[]}k.prototype.getObject=function(){var l=this.pool.pop();if(!l){l=new this.classType()}return l};return k}());b.GameObjectPool=a;var f=(function(){function k(l){this.engine=l;this.sections=data;this.count=0;this.currentSegment=data[0];this.startSegment={length:1135*2,floor:[0,1135],blocks:[],coins:[],platform:[]},this.chillMode=true;this.last=0;this.position=0}k.prototype.reset=function(m){if(m){this.count=0}this.currentSegment=this.startSegment;this.currentSegment.start=-200;for(var l=0;l<this.currentSegment.floor.length;l++){this.engine.floorManager.addFloor(this.currentSegment.start+this.currentSegment.floor[l])}};k.prototype.update=function(){this.position=b.GameConfig.camera.x+b.GameConfig.width*2;var p=this.position-this.currentSegment.start;if(p>this.currentSegment.length){var m=this.sections[this.count%this.sections.length];m.start=this.currentSegment.start+this.currentSegment.length;this.currentSegment=m;var r=this.currentSegment.floor;var o=r.length/1;for(var s=0;s<o;s++){this.engine.floorManager.addFloor(this.currentSegment.start+this.currentSegment.floor[s])}var l=this.currentSegment.blocks;var o=l.length/2;for(var s=0;s<o;s++){var x=l[(s*2)+1];var u=b.GameConfig.height*x/b.GameConfig.fixedHeight;this.engine.enemyManager.addEnemy((b.GameConfig.allSystem.get("background")).bgTex.spriteWidth+100+this.currentSegment.start+l[s*2],u)}var y=this.currentSegment.coins;var o=y.length/2;for(var s=0;s<o;s++){var n=Math.floor(Math.random()*50+400);var w=y[(s*2)+1];var t=b.GameConfig.height*w/b.GameConfig.fixedHeight;this.engine.pickupManager.addPickup((b.GameConfig.allSystem.get("background")).bgTex.spriteWidth+100+this.currentSegment.start+y[s*2]+n,t)}var q=this.currentSegment.platform;var o=q.length/2;for(var s=0;s<o;s++){var z=q[(s*2)+1];var v=b.GameConfig.height*z/b.GameConfig.fixedHeight;this.engine.platManager.addPlatform(this.currentSegment.start+q[s*2],v)}this.count++}};return k}());b.SegmentManager=f;var j=(function(){function k(){this.position=new PIXI.Point();var m=50;var p=b.GameConfig.height*m/b.GameConfig.fixedHeight;var o=p/m;this.platBlockHeight=p;this.platBlockWidth=o*50;this.numberOfBlock=-3+Math.random()*(8-5)+5;this.views=[];for(var n=0;n<this.numberOfBlock*2;n++){var l=new PIXI.Sprite(PIXI.Texture.fromFrame("img/floatingGround.png"));l.anchor.x=0.5;l.anchor.y=0.5;l.width=this.platBlockWidth;l.height=this.platBlockHeight;this.views.push(l)}this.width=this.platBlockWidth*this.numberOfBlock*2;this.height=this.platBlockHeight}k.prototype.update=function(){for(var l=-this.numberOfBlock;l<this.numberOfBlock;l++){this.views[l+this.numberOfBlock].position.x=this.position.x+this.platBlockWidth*l-b.GameConfig.camera.x;this.views[l+this.numberOfBlock].position.y=this.position.y}};return k}());b.Platform=j;var g=(function(){function k(l){this.engine=l;this.platforms=[];this.platformPool=new a(j)}k.prototype.update=function(){for(var m=0;m<this.platforms.length;m++){var l=this.platforms[m];l.update()}};k.prototype.destroyAll=function(){for(var m=0;m<this.platforms.length;m++){var l=this.platforms[m];this.platforms.splice(m,1);m--}this.platforms=[]};k.prototype.addPlatform=function(m,o){var l=this.platformPool.getObject();l.position.x=m;l.position.y=o;for(var n=-l.numberOfBlock;n<l.numberOfBlock;n++){l.views[n+l.numberOfBlock].position.x=l.position.x+50*n-b.GameConfig.camera.x;l.views[n+l.numberOfBlock].position.y=l.position.y;this.platforms.push(l);this.engine.view.gameFront.addChild(l.views[n+l.numberOfBlock])}};return k}());b.PlatformManager=g;var d=(function(){function k(l){this.engine=l;this.enemies=[];this.enemyPool=new a(b.GameEnemy);this.spawnCount=0}k.prototype.update=function(){for(var m=0;m<this.enemies.length;m++){var l=this.enemies[m];l.update();if(l.view.position.x<-100-b.GameConfig.xOffset&&!this.engine.player.isDead){this.enemies.splice(m,1);this.engine.view.gameFront.removeChild(l.view);m--}else{if(l.isHit){this.enemies.splice(m,1);this.engine.view.gameFront.removeChild(l.view);m--}}}};k.prototype.addEnemy=function(l,n){var m=this.enemyPool.getObject();m.position.x=l;m.position.y=n;m.view.textures=m.moveingFrames;m.view.play();this.enemies.push(m);this.engine.view.gameFront.addChild(m.view)};k.prototype.destroyAll=function(){for(var m=0;m<this.enemies.length;m++){var l=this.enemies[m];l.reset();this.engine.view.gameFront.removeChild(l.view)}this.enemies=[]};k.prototype.destroyAllOffScreen=function(){for(var m=0;m<this.enemies.length;m++){var l=this.enemies[m];if(l.x>b.GameConfig.camera.x+b.GameConfig.width){this.engine.view.game.removeChild(l.view);this.enemies.splice(m,1);m--}}};return k}());b.EnemyManager=d;var i=(function(){function k(l){this.canPickOrNot=true;this.MAX_PICKUP_NUM=4;this.engine=l;this.pickups=[];this.pickupPool=new a(b.PickUp);this.spawnCount=0;this.pos=0;this.pickedUpPool=[]}k.prototype.update=function(){for(var m=0;m<this.pickups.length;m++){var l=this.pickups[m];l.update();if(l.isPickedUp){l.ratio+=(1-l.ratio)*0.3*b.GameConfig.time.DELTA_TIME;if(l.ratio>0.99){this.pickups.splice(m,1);this.engine.view.game.removeChild(l.view);m--}}else{if(l.view.position.x<-100-b.GameConfig.xOffset){this.engine.view.game.removeChild(l.view);this.pickups.splice(m,1);m--}}}};k.prototype.addPickup=function(l,n){var m=this.pickupPool.getObject();m.position.x=l;m.position.y=n;this.pickups.push(m);this.engine.view.game.addChild(m.view)};k.prototype.removePickup=function(n,l,r){if(l===void 0){l=true}if(r===void 0){r=undefined}var q=this.pickups[n];q.isPickedUp=true;if(l){q.player=this.engine.player;q.pickupPosition={x:q.position.x,y:q.position.y};q.ratio=0;b.GameConfig.audio.play("pickUpFood");if(this.pickedUpPool.length<this.MAX_PICKUP_NUM-1&&this.canPickOrNot){this.pickedUpPool.push(q.foodType);this.engine.view.specialFood.digits[this.pickedUpPool.length-1].texture=this.engine.view.specialFood.activeFoods[this.pickedUpPool.length-1]}else{if(this.pickedUpPool.length==this.MAX_PICKUP_NUM-1&&this.canPickOrNot){this.pickedUpPool.push(q.foodType);this.engine.view.specialFood.digits[this.pickedUpPool.length-1].texture=this.engine.view.specialFood.activeFoods[this.pickedUpPool.length-1];var p=0;for(var o=0;o<this.pickedUpPool.length;o++){if(this.pickedUpPool[o]==0){p++}}var m=b.SPECIALMODE.NINJAMODE;if(p>2){m=b.SPECIALMODE.JAPANMODE;b.GameConfig.game.player.view.addChild(b.GameConfig.game.player.shinobiEffect1);b.GameConfig.game.player.view.addChild(b.GameConfig.game.player.shinobiEffect2);b.GameConfig.game.player.view.addChild(b.GameConfig.game.player.shinobiEffect3);b.GameConfig.game.player.view.addChild(b.GameConfig.game.player.backEffect);b.GameConfig.audio.play("ninjiaMode")}else{if(p<2){m=b.SPECIALMODE.INDONMODE;b.GameConfig.tmpTimeClockStart=b.GameConfig.time.currentTime;b.GameConfig.game.player.view.addChild(b.GameConfig.game.player.indoEffect);b.GameConfig.audio.play("indoMode")}else{if(p==2){m=b.SPECIALMODE.NINJAMODE;b.GameConfig.tmpTimeClockStart=b.GameConfig.time.currentTime;b.GameConfig.game.player.view.addChild(b.GameConfig.game.player.marioEffect);b.GameConfig.game.player.speed.x*=2;b.GameConfig.audio.stop("GameMusic");b.GameConfig.audio.play("superMarioMode")}}}b.GameConfig.specialMode=m;this.canPickOrNot=false}}}else{q.player=r;q.pickupPosition={x:q.position.x,y:q.position.y};q.ratio=0}};k.prototype.destroyAll=function(){for(var m=0;m<this.pickups.length;m++){var l=this.pickups[m];this.engine.view.game.removeChild(l.view)}this.pickups=[]};k.prototype.destroyAllOffScreen=function(){for(var m=0;m<this.pickups.length;m++){var l=this.pickups[m];if(l.x>b.GameConfig.camera.x+b.GameConfig.width){this.engine.view.game.removeChild(l.view);this.pickups.splice(m,1);m--}}};return k}());b.PickupManager=i;var e=(function(){function k(){this.position=new PIXI.Point();var l=new PIXI.Sprite(PIXI.Texture.fromFrame("img/bg_down.png"));this.view=l}return k}());b.Floor=e;var h=(function(){function k(l){this.engine=l;this.count=0;this.floors=[];this.floorPool=new a(e)}k.prototype.update=function(){for(var l=0;l<this.floors.length;l++){var m=this.floors[l];m.view.position.x=m.position.x-b.GameConfig.camera.x-16;if(m.position.x<-1135-b.GameConfig.xOffset-16){this.floors.splice(l,1);l--;this.engine.view.gameFront.removeChild(m)}}};k.prototype.addFloor=function(l){var m=this.floorPool.getObject();m.position.x=l;m.position.y=(b.GameConfig.allSystem.get("background")).bgTex.spriteHeight-1;m.view.height=b.GameConfig.height-m.position.y+1;m.view.position.y=m.position.y;this.engine.view.gameFront.addChild(m.view);this.floors.push(m)};k.prototype.destroyAll=function(){for(var l=0;l<this.floors.length;l++){var m=this.floors[l];this.engine.view.gameFront.removeChild(m)}this.floors=[]};return k}());b.FloorManager=h;var c=(function(){function k(l){this.isOnPlat=false;this.engine=l}k.prototype.update=function(){this.playerVsBlock();this.playerVsPickup();this.playerVsFloor();this.playerVsPlat();this.catVsPickup()};k.prototype.playerVsBlock=function(){var m=this.engine.enemyManager.enemies;var q=this.engine.player;var p=0;for(var o=0;o<m.length;o++){var l=m[o];if(q.isSlide){p=10}else{if(b.GameConfig.specialMode==b.SPECIALMODE.INDONMODE&&b.GameConfig.game.player.isPlayingInoEffect){p=-2000}else{p=0}}var n=l.position.x-q.position.x;var r=l.position.y-q.position.y;if(n>-l.width/2+p&&n<l.width/2-p){var r=l.position.y-q.position.y;if(r>-l.height/2-20+p&&r<l.height/2-p){b.GameConfig.game.score+=10;switch(b.GameConfig.specialMode){case b.SPECIALMODE.NONE:q.die();this.engine.gameover();l.hit();break;case b.SPECIALMODE.INDONMODE:if(p==-2000){l.hit()}else{q.die();this.engine.gameover();l.hit()}break;case b.SPECIALMODE.JAPANMODE:if(b.GameConfig.game.player.isPlayingNinjiaEffect){l.hit()}else{q.die();this.engine.gameover();l.hit()}break;case b.SPECIALMODE.NINJAMODE:l.hit();break}}}}};k.prototype.catVsPickup=function(){var r=this.engine.pickupManager.pickups;var m=this.engine.enemyManager.enemies;for(var q=0;q<m.length;q++){var l=m[q];if(l.isHit){continue}for(var o=0;o<r.length;o++){var p=r[o];if(p.isPickedUp){continue}var n=p.position.x-l.position.x;if(n>-p.width/2&&n<p.width/2){var s=p.position.y-l.position.y;if(s>-p.height/2-20&&s<p.height/2){l.view.textures=l.stealFrames;b.GameConfig.audio.play("catCome");l.view.play();l.isEatNow=true;this.engine.pickupManager.removePickup(o,false,l)}}}}};k.prototype.playerVsPickup=function(){var p=this.engine.pickupManager.pickups;var o=this.engine.player;for(var n=0;n<p.length;n++){var m=p[n];if(m.isPickedUp){continue}var l=m.position.x-o.position.x;if(l>-m.width/2&&l<m.width/2){var q=m.position.y-o.position.y;if(q>-m.height/2-20&&q<m.height/2){this.engine.pickupManager.removePickup(n);this.engine.pickup(n)}}}};k.prototype.playerVsPlat=function(){var q=this.engine.player;var n=this.engine.platManager.platforms;for(var p=0;p<n.length;p++){var m=n[p];var o=m.position.x-q.position.x;if(o>-m.width/2&&o<m.width/2){var r=m.position.y-q.position.y;if(r>-m.height/2-20&&r<m.height/2){if(q.position.y<m.position.y-20){q.position.y=m.position.y-m.height-q.height-20;q.ground=q.position.y;b.GameConfig.isOnPlat=true;q.onGround=true}}}}if(b.GameConfig.isOnPlat){var l=true;for(var p=0;p<n.length;p++){var m=n[p];var o=m.position.x-q.position.x;if(o>-m.width/2&&o<m.width/2){var r=m.position.y-m.height-q.height-q.position.y-20;if(r<=0){l=false}}}if(l){b.GameConfig.isOnPlat=false;q.ground=this.engine.player.floorHeight;b.GameConfig.playerMode=b.PLAYMODE.FALL;q.onGround=false}}};k.prototype.playerVsFloor=function(){var p=this.engine.floorManager.floors;var o=this.engine.player;var l=p.length;o.onGround=false;if(o.position.y>b.GameConfig.height){if(this.engine.isPlaying){o.boil();this.engine.gameover()}else{o.speed.x*=0.95;if(!b.GameConfig.interactive){b.GameConfig.interactive=true}if(o.bounce===0){o.bounce++;o.boil()}return}}for(var n=0;n<l;n++){var q=p[n];var m=q.position.x-o.position.x+1135;if(o.position.y>=this.engine.player.floorHeight){if(m>0&&m<1135){if(o.isDead){o.bounce++;if(o.bounce>2){return}o.speed.y*=-0.7;o.speed.x*=0.8;if(o.rotationSpeed>0){o.rotationSpeed=Math.random()*-0.3}else{if(o.rotationSpeed===0){o.rotationSpeed=Math.random()*0.3}else{o.rotationSpeed=0}}}else{o.speed.y=-0.3}if(!o.isFlying){o.position.y=this.engine.player.floorHeight;o.onGround=true}}}}};return k}());b.CollisionManager=c})(ECS||(ECS={}));var ECS;(function(a){var b=(function(c){__extends(d,c);function d(){var e=c.call(this,"game kernel")||this;e.view=(a.GameConfig.allSystem.get("view"));e.player=new a.GameCharacter();e.segmentManager=new a.SegmentManager(e);e.enemyManager=new a.EnemyManager(e);e.platManager=new a.PlatformManager(e);e.pickupManager=new a.PickupManager(e);e.floorManager=new a.FloorManager(e);e.collisionManager=new a.CollisionManager(e);e.LocalData=new a.GameLocalData(a.GameConfig.localID);e.player.view.visible=false;e.bulletMult=1;e.pickupCount=0;e.score=0;e.distanceScore=0;e.isPlaying=false;e.levelCount=0;e.gameReallyOver=false;e.isDying=false;e.view.game.addChild(e.player.view);return e}d.prototype.start=function(){this.segmentManager.reset();this.enemyManager.destroyAll();this.pickupManager.destroyAll();this.platManager.destroyAll();this.isPlaying=true;this.gameReallyOver=false;this.player.level=1;this.player.speed.y=0;this.player.speed.x=this.player.baseSpeed;this.player.view.rotation=0;this.player.isFlying=false;this.player.isDead=false;this.player.view.play();this.player.view.visible=true;this.segmentManager.chillMode=false;this.bulletMult=1;a.GameConfig.audio.stop("StartMusic");a.GameConfig.audio.setVolume("GameMusic",0.5);a.GameConfig.audio.play("GameMusic")};d.prototype.update=function(){a.GameConfig.time.update();var e=0;if(e>0){e=0}if(e<-70){e=-70}a.GameConfig.camera.y=e;if(a.GameConfig.gameMode!==a.GAMEMODE.PAUSED){this.player.update();this.collisionManager.update();this.platManager.update();this.segmentManager.update();this.floorManager.update();this.enemyManager.update();this.pickupManager.update();this.levelCount+=a.GameConfig.time.DELTA_TIME;if(this.levelCount>(60*60)){this.levelCount=0;this.player.level+=0.05;a.GameConfig.time.speed+=0.05}}this.view.update()};d.prototype.gameover=function(){this.isPlaying=false;this.isDying=true;this.segmentManager.chillMode=true;var e=this.LocalData.get("highscore");if(!e||this.score>e){this.LocalData.store("highscore",this.score);a.GameConfig.newHighscore=true}this.view.game.addChild(this.player.view);TweenLite.to(this.view,0.5,{zoom:2,ease:Cubic.easeOut})};d.prototype.pickup=function(e){if(this.player.isDead){return}this.pickupCount++};return d}(a.System));a.GameKernelSystem=b})(ECS||(ECS={}));var ECS;(function(c){function e(){c.GameConfig.game.update();requestAnimationFrame(e)}c.update=e;var d=(function(f){__extends(g,f);function g(h){var i=f.call(this,"main")||this;i.OtherSystems=h;return i}g.prototype.Execute=function(){f.prototype.Execute.call(this);this.OtherSystems.forEach(function(h,i){i.Execute()})};return g}(c.System));c.MainSystem=d;var b=(function(g){__extends(f,g);function f(){var h=g.call(this,"loading")||this;h.device=new Utils.DeviceDetect();c.GameConfig.audio=new c.GameAudio();Howler.mobileAutoEnable=true;h.resourceList=["img/light1.png","img/light2.png","img/doroCat.png","img/dash_stock.png","img/blade.png","img/bg_up.png","img/bg_up_ios.png","img/bg_down.png","img/PlayPanel/btn_jump.png","img/PlayPanel/btn_slide.png","img/PlayPanel/btn_atk.png","img/floatingGround.png","assets/background/BackgroundAssets.json","assets/food/food.json","assets/obstacle/obstacle.json","assets/playUI/playPanel.json","assets/playUI/number.json","assets/character/chara1.json","assets/specialEffect/WorldAssets-hd.json"];return h}f.prototype.playStartScreenMusic=function(){c.GameConfig.audio.setVolume("StartMusic",0.5);c.GameConfig.audio.play("StartMusic")};f.prototype.loadingAnime=function(){var j=[];for(var h=0;h<3;h++){var k=PIXI.loader.resources["img/Loading"+(h+1)+".png"].texture;j.push(k)}var l=new PIXI.extras.AnimatedSprite(j);l.x=this.width*0.5;l.y=this.height*0.7;l.anchor.set(0.5);l.animationSpeed=0.1;l.play();this.loadingStage.addChild(l)};f.prototype.Init=function(){var h=this;g.prototype.Init.call(this);this.width=window.innerWidth;this.height=window.innerHeight;this.app=new PIXI.Application({width:this.width,height:this.height,antialias:true,transparent:false,resolution:1});this.app.renderer.backgroundColor=398905;this.app.renderer.view.style.position="absolute";this.app.renderer.view.style.display="block";this.app.renderer.autoResize=true;this.app.renderer.resize(this.width,this.height);document.body.appendChild(this.app.view);this.loadingFrames=["img/Loading1.png","img/Loading2.png","img/Loading3.png"];this.bgImage="img/bg.png";this.logoImage="img/logo.png";PIXI.loader.add(this.loadingFrames).add(this.bgImage).add(this.logoImage).load(function(){h.loadingStage=new PIXI.Container();var j=new PIXI.Sprite(PIXI.loader.resources[h.bgImage].texture);j.anchor.x=0;j.anchor.y=0;j.height=h.height;j.width=h.width;h.loadingStage.addChild(j);var k=new PIXI.Sprite(PIXI.loader.resources[h.logoImage].texture);k.anchor.set(0.5);k.position.x=h.width*0.5;k.position.y=h.height*0.4;var i=k.width/k.height;k.height=h.height/2;k.width=k.height*i;h.loadingStage.addChild(k);h.loadingAnime();h.app.stage.addChild(h.loadingStage);h.LoadGameResources()})};f.prototype.LoadGameResources=function(){var h=this;PIXI.loader.add(this.resourceList).load(function(){h.app.stage.removeChild(h.loadingStage);c.GameConfig.app=h.app;c.GameConfig.width=h.width;c.GameConfig.height=h.height;c.GameConfig.device=h.device;c.GameConfig.allSystem=new Utils.HashSet();var l=c.GameConfig.allSystem;l.set("background",new c.GameBackGroundSystem());l.set("view",new c.GameViewSystem());l.set("kernel",new c.GameKernelSystem());var k=new d(l);c.GameConfig.game=l.get("kernel");var i=new a();i.bindEvent();var j=c.GameConfig.game;j.view.showHud();e();j.start();c.GameConfig.gameMode=c.GAMEMODE.PLAYING;c.GameConfig.playerMode=c.PLAYMODE.RUNNING})};f.prototype.Execute=function(){g.prototype.Execute.call(this)};return f}(c.System));c.LoadingSystem=b;var a=(function(g){__extends(f,g);function f(){return g.call(this,"eventlistener")||this}f.prototype.bindEvent=function(){window.addEventListener("keydown",this.onKeyDown,true);window.addEventListener("keyup",this.onKeyUp,true)};f.prototype.onKeyDown=function(h){if(h.keyCode==32||h.keyCode==38){if(c.GameConfig.game.isPlaying&&c.GameConfig.playerMode==c.PLAYMODE.RUNNING&&!c.GameConfig.game.player.isPlayingNinjiaEffect){c.GameConfig.game.player.jump();c.GameConfig.audio.play("jump")}else{if(c.GameConfig.game.isPlaying&&c.GameConfig.playerMode==c.PLAYMODE.FALL&&c.GameConfig.game.player.startJump==true&&!c.GameConfig.game.player.isPlayingNinjiaEffect){c.GameConfig.game.player.jumpTwo();c.GameConfig.audio.play("jump")}}}else{if(h.keyCode==40){if(c.GameConfig.game.isPlaying&&c.GameConfig.playerMode==c.PLAYMODE.RUNNING&&c.GameConfig.game.player.onGround){c.GameConfig.game.player.slide(true)}}else{if(h.keyCode==39){if(c.GameConfig.game.isPlaying&&c.GameConfig.specialMode==c.SPECIALMODE.JAPANMODE){c.GameConfig.audio.play("ninjiaModeAttack");c.GameConfig.game.player.view.textures=c.GameConfig.game.player.dashFrames;c.GameConfig.game.player.view.play();c.GameConfig.game.player.ninjiaOperate()}else{if(c.GameConfig.game.isPlaying&&c.GameConfig.specialMode==c.SPECIALMODE.INDONMODE){c.GameConfig.audio.play("indoMode");c.GameConfig.game.player.view.textures=c.GameConfig.game.player.runningFrames;c.GameConfig.game.player.view.play();c.GameConfig.game.player.indoOperate()}}}}}};f.prototype.onKeyUp=function(h){if(h.keyCode==40){if(c.GameConfig.game.isPlaying&&c.GameConfig.game.player.isSlide){c.GameConfig.game.player.slide(false)}}};return f}(c.System));c.EventListenerSystem=a})(ECS||(ECS={}));var load_system=new ECS.LoadingSystem();if(load_system.device.desktop){$("#modal_movie").modal("show");load_system.playStartScreenMusic()}else{$("#modal_setting").modal("show")}var startGame=function(){load_system.Init()};document.getElementById("btn_play").onclick=function(){document.getElementById("global").style.display="none";startGame()};document.getElementById("openMusic").onclick=function(){load_system.playStartScreenMusic();$("#modal_setting").modal("hide");$("#modal_movie").modal("show")};document.getElementById("btn_close").onclick=function(){$("#modal_movie").modal("show")};var ECS;(function(b){var a=(function(){function d(e){PIXI.Sprite.call(this,PIXI.Texture.fromFrame(e));this.anchor.x=0.5;this.anchor.y=0.5;this.speed=new PIXI.Point()}return d}());b.ExplosionPartical=a;a.prototype=Object.create(PIXI.Sprite.prototype);var c=(function(){function d(){PIXI.DisplayObjectContainer.call(this);this.particals=[];this.top=new a("asplodeInner02.png");this.bottom=new a("asplodeInner01.png");this.top.position.y=-20;this.bottom.position.y=20;this.top.position.x=20;this.bottom.position.x=20;this.anchor=new PIXI.Point();this.addChild(this.top);this.addChild(this.bottom);this.particals=[this.top,this.bottom];for(var f=0;f<5;f++){this.particals.push(new a("asplodeSpike_01.png"));this.particals.push(new a("asplodeSpike_02.png"))}this.clouds=[];for(var f=0;f<5;f++){var e=new PIXI.Sprite.fromFrame("dustSwirl.png");this.clouds.push(e);this.addChild(e)}this.reset()}return d}());b.Explosion=c;c.prototype=Object.create(PIXI.DisplayObjectContainer.prototype);c.prototype.explode=function(){this.exploding=true};c.prototype.reset=function(){for(var f=0;f<5;f++){var e=this.clouds[f];e.anchor.x=0.5;e.anchor.y=0.5;e.scaleTarget=2+Math.random()*2;e.scale.x=e.scale.x=0.5;e.alpha=0.75;e.position.x=(Math.random()-0.5)*150;e.position.y=(Math.random()-0.5)*150;e.speed=new PIXI.Point(Math.random()*20-10,Math.random()*20-10);e.state=0;e.rotSpeed=Math.random()*0.05}for(var f=0;f<this.particals.length;f++){var d=this.particals[f];this.addChild(d);var h=(f/this.particals.length)*Math.PI*2;var g=7+Math.random();d.directionX=Math.cos(h)*g;d.directionY=Math.sin(h)*g;d.rotation=-h;d.rotationSpeed=Math.random()*0.02}};c.prototype.updateTransform=function(){if(this.exploding){for(var f=0;f<this.clouds.length;f++){var e=this.clouds[f];e.rotation+=e.rotSpeed;if(e.state===0){e.scale.x+=(e.scaleTarget-e.scale.x)*5;e.scale.y=e.scale.x;if(e.scale.x>e.scaleTarget-0.1){e.state=1}}else{e.position.x+=e.speed.x*0.05;e.position.y+=e.speed.y*0.05}}for(var f=0;f<this.particals.length;f++){var d=this.particals[f];d.directionY+=0.1;d.directionX*=0.99;d.position.x+=d.directionX;d.position.y+=d.directionY;d.rotation+=d.rotationSpeed}}PIXI.DisplayObjectContainer.prototype.updateTransform.call(this)}})(ECS||(ECS={}));